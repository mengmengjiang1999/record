# Investigating the Security of OpenPLC: Vulnerabilities, Attacks, and Mitigation Solutions

https://ieeexplore.ieee.org/abstract/document/10409502


2024年的新论文


因为OpenPLC被很多厂商实际使用了，所以去fuzzing OpenPLC

摘要部分介绍了开源的可编程逻辑控制器（OpenPLC）软件，该软件被设计为厂商中立，能够在几乎所有的计算机或低成本嵌入式设备上运行，例如树莓派（Raspberry Pi）、Arduino等。OpenPLC旨在提供一个经济实惠且实用的解决方案，以替代成本较高的实际硬件PLC，已在研究和工业社区中引起了广泛关注。随着其受欢迎程度的增加，了解其安全漏洞并实施有效的缓解策略变得至关重要。

文章通过威胁建模、漏洞分析和实际实验的结合，为开发者、研究人员和工程师提供了宝贵的见解，以安全地在工业环境中部署OpenPLC。研究首先进行了深入分析，以揭示OpenPLC项目中的各种安全挑战和漏洞，包括未授权访问、通信协议的漏洞、对数据完整性的担忧、缺乏强大的加密机制等问题。然后，研究展示了如果这些漏洞被利用，可能会产生的后果，即通过执行复杂的控制逻辑注入攻击，恶意修改在OpenPLC运行时上运行的用户程序，且这种注入攻击隐蔽性强，不易被合法用户察觉。

最后，文章介绍了一个名为OpenPLC Aqua的安全增强型OpenPLC软件。这个新开发的软件配备了一系列专门设计的安全解决方案，用以解决当前OpenPLC版本所固有的漏洞。所有的攻击代码以及OpenPLC Aqua软件都已公开提供，以便社区使用和进一步研究。

Software PLC是什么？

在文章中，Software PLC（软件PLC）被定义为一种软件实现的可编程逻辑控制器，它与传统的硬件PLC相比，具有硬件和软件部分或完全解耦的特性。软件PLC分为两个子类别，各有不同的特点：

1. **特定硬件的软件PLC（Hardware specific software PLCs）**：
   - 这类软件PLC设计为在来自同一供应商的特定硬件配置上运行。
   - 它们执行的控制逻辑部分与硬件解耦，允许用户在同一个制造商生产的不同硬件模型上无缝运行这些控制逻辑。
   - 尽管如此，这类PLC在与同一供应商的硬件设备（例如两个PLC代际的设备）配合使用时仍存在一些兼容性限制。
   - 例如，西门子提供的S7-1500 PLC就属于这一类，它可以在同一家族和供应商的不同设备上运行控制逻辑。

2. **硬件不可知的软件PLC（Hardware agnostic software PLCs）**：
   - 这类PLC设计为独立于底层硬件，提供更大的硬件兼容性灵活性。
   - 它们可以在各种硬件平台上运行，不受制造商的限制。
   - 用户可以根据需求选择硬件，软件PLC预期能够适应不同的硬件配置。
   - 这类PLC通常设计为遵循开放的通信和编程标准，促进互操作性，并且可以轻松地扩展和适应不同的系统规模和复杂性。
   - 例如，CODESYS软件PLC就具有可以在不同供应商的多种硬件上运行的控制逻辑引擎。

软件PLC因其成本效益、灵活性、可扩展性、能效、快速适应性、逼真的仿真能力以及与IT系统的无缝集成等优势而受到广泛关注，这些属性通常是传统PLC所缺乏的。随着工业自动化和智能制造的发展，软件PLC预计将在特定应用中取代传统PLC，其市场份额预计会从2019年的3.5%增长到2025年的7%。



**A. OPENPLC PROJECT** 部分详细介绍了OpenPLC项目的由来、目标、发展以及它在工业自动化领域的应用情况。以下是这部分内容的概述：

1. **OpenPLC的引入**：2014年，Alves首次提出了OpenPLC，这是一个开源软件PLC，作为昂贵硬件PLC的成本效益替代品。项目最初旨在支持研究社区，让科学家和学术研究人员能够建立小型ICS环境进行研究实验。

2. **OpenPLC的发展**：由于其众多优势，OpenPLC在近年来经历了显著的发展，并在成本是关键因素的小到中等规模工业环境中找到了应用。

3. **OpenPLC的应用**：OpenPLC已经被应用于多种不同的背景，包括家庭自动化系统、交通灯、水处理厂、现场区域网络和供暖、通风与空调（HVAC）系统的控制等。它也被用于农业领域，如控制灌溉系统、监测环境条件和管理机械操作。

4. **OpenPLC的特点**：
   - **开源性质**：OpenPLC提供可自由访问的源代码。
   - **符合IEC 61131-3标准**：支持国际电工委员会（IEC）指定的通用编程语言。
   - **与低成本硬件兼容**：与包括Raspberry Pi、Arduino、BeagleBone在内的多种低成本硬件设备兼容。

5. **OpenPLC的普及原因**：OpenPLC之所以受到欢迎，是因为它具有开放源代码、与多种低成本硬件设备兼容、支持IEC标准等特性，使得工程师能够在不受特定供应商或配置限制的情况下，在各种真实硬件平台上测试和实施控制逻辑程序。

6. **安全风险**：尽管OpenPLC具有许多优势，但它也存在显著的安全风险，可能使基于OpenPLC的系统面临多种网络攻击的威胁。

7. **研究的必要性**：鉴于OpenPLC项目的日益普及，识别和解决其安全漏洞变得迫切重要。文章强调了对OpenPLC进行安全调查的必要性，以识别并修复漏洞，提高项目的安全性。

8. **OpenPLC Aqua的介绍**：最后，该部分提到了OpenPLC Aqua，这是一个安全增强版的OpenPLC软件，旨在解决当前版本OpenPLC所面临的安全问题。

总的来说，**A. OPENPLC PROJECT** 部分为读者提供了OpenPLC项目的全面介绍，包括其起源、应用场景、优势、面临的安全挑战，以及为了提高安全性而开发的新版本OpenPLC Aqua。



大概就是给OpenPLC打了一个补丁，OpenPLC plus版。这一部分说明了已经发现的OpenPLC的漏洞，下一部分给出了OpenPLC的补丁。

**C. SCOPE OF OUR WORK** 部分详细阐述了文章研究OpenPLC项目安全的具体范围和目标。以下是这部分内容的概括：

1. **OpenPLC项目的安全调查**：研究聚焦于OpenPLC项目的安全问题，特别是设计上的缺陷，这些缺陷可能允许攻击者窃取可执行程序，尤其是位于Web服务器中的程序，并随后成功地进行控制逻辑注入攻击。

2. **通信渠道的安全风险**：文章强调了OpenPLC软件使用的通信渠道容易受到安全风险的影响。由于缺乏加密，敏感数据（如用户凭证、控制命令、配置等）可能被攻击者截获、操纵和破坏，从而危及数据传输的完整性。

3. **控制逻辑注入攻击**：为了支持研究发现，作者进行了一次复杂的控制逻辑注入攻击实验。这种攻击使外部敌手不仅能够未经授权地访问OpenPLC运行时，还能够破坏受控的物理过程。

4. **无需用户凭证的攻击**：引人注目的是，这种攻击场景可以在没有用户凭证或特定物理过程详细信息的情况下执行，这意味着攻击者可以在用户完全不知情的情况下进行攻击。

5. **OpenPLC Aqua的介绍**：为了解决调查中揭示的所有漏洞，作者介绍了一个名为OpenPLC Aqua的更安全的OpenPLC软件版本。这个新软件包含了一系列旨在增强OpenPLC项目整体安全性和可靠性的健壮安全措施。

6. **OpenPLC Aqua的安全特性**：OpenPLC Aqua的一个显著特点是使用高级加密标准（AES）算法对用户凭证（包括用户名和密码）进行加密，并将AES算法的输出从二进制编码为美国信息交换标准代码（ASCII）。这种方法防止了潜在攻击者截获明文用户凭证或尝试从OpenPLC项目文件（如openplc.db数据库）中检索它们。

7. **受限的Web服务器和数据库访问**：OpenPLC Aqua通过限制对Web服务器和openplc.db数据库的访问，只允许具有根权限的合法用户，从而提高了安全性。这阻止了未授权用户访问关键数据，例如控制逻辑、用户凭证和配置设置。

8. **白名单功能**：OpenPLC Aqua引入了一个新颖的白名单功能，只允许预先批准或信任的用户上传新程序到OpenPLC运行时。该功能旨在检测任何未经授权的用户试图操纵运行程序的恶意尝试。

9. **SSL/TLS协议的实现**：最后，新软件通过实施安全套接字层/传输层安全（SSL/TLS）协议，确保了客户端（用户）和服务器（OpenPLC）之间通过互联网传输的所有数据的安全性。这一保障确保了信息的保密性，使其对恶意攻击者不可访问，并防止了窃听和数据篡改。

**C. SCOPE OF OUR WORK** 部分清晰地定义了文章的工作范围，并详细说明了作者在提高OpenPLC软件安全性方面的工作和贡献。



**D. COMPARING OUR WORK TO OTHERS** 这一部分对作者的研究工作与之前关于OpenPLC安全性的研究进行了比较和对照。以下是这段内容的概括：

1. **先前研究的不足**：作者指出，直至文章撰写之时，还没有全面深入探讨与OpenPLC项目相关的安全方面的论文，包括调查新的漏洞、潜在攻击以及引入相应的安全解决方案。

2. **与Xinxin的研究比较**：Xinxin的研究[16]分析了OpenPLC运行时操作的四个阶段，并监控了Linux内核安全模块（LSM）的所有钩函数。这项研究揭示了软件中的几个严重漏洞，例如ST文件完整性问题、相关内存易受篡改、不安全的网络通信等。基于这些发现，Xinxin开发了一个名为AESI-PLC的安全增强软件，与原始OpenPLC软件相比，它提供了更好的抵抗中间人攻击、重放攻击和命令注入攻击的能力。然而，作者没有考虑控制逻辑注入攻击的可能性，尤其是文章中第四部分概述的隐蔽攻击场景。

3. **控制逻辑注入攻击**：作者介绍了几种针对OpenPLC软件和相关系统的攻击场景研究。例如，Alves和Morris[9]展示了针对不同供应商（Schneider、Siemens、Omron和OpenPLC）的PLC的Modbus命令注入攻击，并评估了每个设备在这种攻击下的行为。其他研究小组对OpenPLC[11]进行了命令注入攻击，利用OpenPLC运行时中的“硬件层代码框”中的安全漏洞，成功执行了任意代码。

4. **OpenPLC Aqua的安全性**：作者介绍了OpenPLC Aqua，这是一个增强版的OpenPLC软件，实施了一系列安全解决方案，专门针对当前版本OpenPLC所固有的所有漏洞。OpenPLC Aqua的架构包括四个关键安全特性：用户凭证加密、受限可访问性、白名单方法和安全的通信渠道。为了验证新软件的安全性，它经过了针对旧版OpenPLC可能遭受的几种攻击的严格测试。测试结果表明，OpenPLC Aqua成功抵御了所有进行的攻击。

5. **研究贡献**：文章的主要贡献包括对OpenPLC软件进行了全面的安全调查，揭示了OpenPLC项目设计中的几个漏洞；首次针对基于OpenPLC的系统引入了控制逻辑注入攻击；开发了增强版的OpenPLC软件（OpenPLC Aqua），解决了当前OpenPLC版本中存在的漏洞，同时保持与旧版本相同的硬件设备兼容性。

**D. COMPARING OUR WORK TO OTHERS** 这一部分强调了作者研究的新颖性和全面性，以及与现有研究相比，他们提出的安全解决方案的有效性。


**E. CONTRIBUTION** 这一段总结了作者在本文中的主要贡献，具体如下：

1. **全面的OpenPLC软件安全调查**：与之前对OpenPLC安全性的研究相比，作者的工作提供了一个全面的调查，揭示了OpenPLC项目设计中的多个漏洞。

2. **针对OpenPLC系统的控制逻辑注入攻击**：文章介绍了首个为OpenPLC和相关应用/系统量身定制的控制逻辑注入攻击。这种注入方法恶意地更改了正在进行的用户程序，从而在被OpenPLC控制的物理过程中造成混乱。

3. **隐藏恶意注入**：为了增加攻击的严重性和隐蔽性，作者利用项目文件中的安全漏洞有效地掩盖了攻击，使得合法用户在攻击进行时仍然不知情。

4. **开发增强版的OpenPLC软件（OpenPLC Aqua）**：基于研究发现，作者增强了OpenPLC软件，引入了一个更安全的版本，称为OpenPLC Aqua。这个新软件解决了当前OpenPLC版本中存在的漏洞，同时保持与旧版本相同的硬件设备兼容性。OpenPLC Aqua公开提供给学术研究人员和工业工程师使用。

作者的这些贡献不仅提高了OpenPLC软件的安全性，还为未来的研究和实践提供了宝贵的资源和指导。通过这些工作，作者希望能够促进OpenPLC项目的安全发展，并帮助保护基于OpenPLC的系统免受网络攻击的威胁。



后面就是详细介绍了OpenPLC的漏洞、攻击过程


然后讲了OpenPLC AQUA对于PLC做的一些升级。不过OpenPLC的v3是2018年的