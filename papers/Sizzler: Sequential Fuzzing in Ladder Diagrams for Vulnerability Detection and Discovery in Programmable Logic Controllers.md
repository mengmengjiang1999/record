# Sizzler: Sequential Fuzzing in Ladder Diagrams for Vulnerability Detection and Discovery in Programmable Logic Controllers

https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=10347559&tag=1

https://github.com/7linux-0/Sizzler

开源是开源了但是这也太惨了吧，0watch 0fork 0star

Sizzler是专门为梯形图做fuzzing的

fuzzing部分：

The current GAN-based fuzzer concentrates on the generation process. In contrast, Sizzler focuses on the mutation strategy within fuzzing, building upon the foundation of American Fuzzy Lop (AFL) 

简而言之就是Sizzler的mutation算法挺高级的，算论文提出的创新点。但是这相比AFL做了什么改进吗，我确实很想知道，总之论文里没说


实际上就是把LD代码转换成C代码（不知道用的啥转换，先假设是OpenPLC吧），然后在rehosting（目前的理解是这样，不确定再看看）


作者自己说明了PLC领域很容易出现各种各样的漏洞。例如：

（以下内容来自ai）

这段文字讨论了在PLC（可编程逻辑控制器）领域中，当前的LD（逻辑设计）编译器缺乏检测漏洞或由逻辑注入引起的复杂逻辑错误的能力。为了构建30个PLC二进制应用程序，作者故意在LD程序中引入了各种类型的漏洞。这些漏洞包括：
- 竞态条件竞争：当两个进程同时请求同一资源时发生。在LD程序中，两个逻辑操作数同时执行并相互竞争，即使输入相同，也可能导致意外的输出。
- 缺少特定的线圈或输出：缺少特定输出线圈，如输出激活（OTE）、锁存器或设置、解锁等，可能导致依赖问题，影响其他标签。
- 无限循环：如果LD包含无限循环，它可能会消耗过多的CPU资源，导致PLC崩溃。
- 硬编码逻辑比较器：嵌入到应用程序中，攻击者可以访问。这些硬编码指令和值可以通过逆向工程从PLC中获取，然后修改以操纵PLC程序的操作。
- 缺少跳转和链接：跳转和链接可能不会按照控制流执行。攻击者可以识别这些内存地址，并利用这些空间插入恶意代码。
- 隐藏跳线：可以利用PLC中的跳转机制跳过某些元素。如果跳线被编码为绕过给定梯形图中的单个元素，那么可能放弃多个元素甚至整个分支。
- 对象重复引用：当一个输出可能由不同的输入控制时，就会发生这种情况。在LD中，某些操作数，对于OTE、计时器和计数器，可能会有不同的结果，这取决于具有相似逻辑的不同梯形图的扫描。例如，图3(b)中的y1输出线圈在LD中被重复，将根据执行的梯形图被去激活，导致不期望的输出。
- 未使用的对象：在大规模PLC程序中，有些变量可能保持未使用状态，编译器将无法检测到。开放和预实例化的入口点在系统中呈现潜在的漏洞。这种漏洞源于攻击者可以轻易地将恶意代码插入系统。

这些实施的漏洞可能会对实际的ICS（工业控制系统）设置造成严重损害。例如，攻击者可以获得根权限并植入后门来监视和控制PLC的行为。此外，获得对硬编码PLC应用程序的访问权限可以允许攻击者获取敏感信息，例如各种关键行业中的温度和压力值，导致不可预测的后果。

**主要内容概括**：
这段文字讨论了PLC LD编译器在检测逻辑错误和漏洞方面的不足，并描述了作者为了测试而构建的30个带有故意漏洞的PLC应用程序。这些漏洞包括竞态条件、缺少输出、无限循环、硬编码逻辑比较器、缺少跳转和链接、隐藏跳线、对象重复引用以及未使用的对象。这些漏洞可能会被攻击者利用，造成严重的安全问题，如获得控制权、植入后门、获取敏感信息等，导致不可预测的后果。


**翻译**：
我们通过将前面讨论的漏洞嵌入到LD项目中来构建我们的仿真测试平台。挑战与将项目转换为可执行二进制文件以模拟它们的应用级特性有关。因此，我们利用开源的LDmicro编译器和OpenPLC将项目转换为可以编译并执行为二进制文件的C程序。OpenPLC和LDmicro的编译器能够定义PLC引脚使用的值和地址。OpenPLC还可以直接将Modbus地址空间映射到物理I/O。生成C代码的过程包括三个阶段：
1）对LD进行词法和语法检查；
2）编译器生成符号表，例如全局声明的函数、程序组织单元（POUs）以及为枚举类型声明的标识符；
3）分析执行的控制流和数据类型，以注释抽象语法树并生成C代码。
生成的C文件概述了PLC运行时，通过根据内存映射建立通信相关函数的数组来启动。这个数组包括了外围和进程间函数，它们被实例化为线程。随后在运行时加载LD，然后执行指令。在内存映射中定义的I/O模块在接收模拟和数字信号中起着至关重要的作用，并作为模糊测试生成PLC程序输入的媒介。

**主要内容概括**：
本文段描述了如何将包含特定漏洞的LD（梯形图）项目转换为可执行的二进制文件，以便在仿真测试平台中模拟PLC（可编程逻辑控制器）的应用级特性。作者使用了开源的LDmicro编译器和OpenPLC工具，将LD项目转换成C语言程序，这些程序可以编译并执行为二进制文件。转换过程涉及三个主要阶段：词法和语法检查、生成包含函数和枚举类型标识符的符号表，以及分析控制流和数据类型以生成C代码。生成的C代码文件描述了PLC的运行时环境，包括通信相关函数的数组、线程实例化，以及在运行时加载和执行LD指令。此外，内存映射中定义的I/O模块对于接收信号和生成PLC程序的输入至关重要，是模糊测试的关键组成部分。

后面说了，使用OpenPLC编译成C代码，然后用QEMU做simulation。具体外设的部分进行替换。


创新点是SeqGAN，数据生成方式。这个创新点跟PLC实际上没有任何关系。


## EVALUATION

测试1: 测试目标是非工业系统的测试集。这个测试做得很迷惑，他想要测试这个策略对非工业系统的通用性（所以和你的创新点有什么关系吗）

测试2: 在Sizzler、P2IM和μEmu之间进行了比较分析，比较的内容是对于外设的处理成功率。（所以和你的创新点有什么关系吗）

测试3: C. PLC Code Vulnerability Discovery 首先说明覆盖率还可以，第二说明使用Sizzler做fuzzing的过程中，发现了除了自己注入的漏洞之外的漏洞。

测试4: 真的报告了一个CVE，好像是由于OpenPLC引入的。另外是复现了一个已经报告的CVE。

测试5: E. General Vulnerability Detection 感觉跟PLC已经完全没关系了
