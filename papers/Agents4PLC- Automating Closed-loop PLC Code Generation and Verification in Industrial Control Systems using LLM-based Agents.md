# Agents4PLC- Automating Closed-loop PLC Code Generation and Verification in Industrial Control Systems using LLM-based Agents



@article{agents4plc,
  title={Agents4plc: Automating closed-loop plc code generation and verification in industrial control systems using llm-based agents},
  author={Liu, Zihan and Zeng, Ruinan and Wang, Dongxia and Peng, Gengyun and Wang, Jingyi and Liu, Qiang and Liu, Peiyu and Wang, Wenhai},
  journal={arXiv preprint arXiv:2410.14209},
  year={2024}
}


二、背景

二-A PLC编程语言

可编程逻辑控制器（PLC）是专为工业自动化控制设计的计算机系统，能够实现对机械设备与生产流程的实时监控与控制。凭借高可靠性、易编程性和可扩展性等优势，PLC被广泛应用于制造业、交通运输、能源等诸多领域。国际电工委员会标准IEC 61131-3 [20] 为PLC规定了五种标准编程语言，包括三种图形化语言：梯形图（LAD）、功能块图（FBD）和顺序功能图（SFC），以及两种文本化语言：结构化文本（ST）和指令表（IL）。其中，结构化文本（ST）语言在语法和结构上类似于C语言和Pascal等传统高级编程语言，具有显著的灵活性和可读性。它支持循环、条件语句等常见编程结构，因而广泛应用于需要复杂数学计算、数据处理和高级控制算法的场景。随着工业4.0和智能制造的发展，ST语言因其能够与其他编程语言互补以增强PLC系统的灵活性和效率，展现出极佳的应用前景。

二-B 语法检查与功能验证

由大语言模型（LLM）生成的代码常存在显著的不确定性，可能无法通过编译或满足特定需求[45]。因此，语法检查确保生成的ST代码是可执行的，而功能验证则确保代码能够实现预期功能，避免潜在的逻辑缺陷或漏洞[15]。

二-B1 语法检查

代码必须首先符合编程语言规范，才能被编译成可执行程序。许多PLC集成开发环境（IDE），如CODESYS和TwinCAT，都能够对ST代码进行语法检查。这些IDE遵循IEC 61131-3标准，并提供编程、调试和仿真等功能。然而，受限于其平台特性，这些IDE不易直接集成到自动化代码生成流水线中。此外，一些命令行工具也能完成ST代码的语法检查与编译。例如，MATIEC [2] 是一个开源编译器，能够将ST代码重构或编译成C语言，广泛应用于工业自动化系统的设计与维护。RuSTy [6] 则是一个基于LLVM和Rust的开源项目，旨在创建一个快速、现代、开源且适用于广泛平台的工业级ST编译器，以提供全面的编译反馈。

二-B2 功能验证

功能验证对于PLC代码至关重要，它能确保生成的ST代码在实际应用中能够准确、可靠地实现预期的控制逻辑与操作，从而避免因逻辑错误或未预见到的情况导致设备故障或生产中断。目前存在一些形式化验证工具可用于ST代码的功能验证，例如nuXmv [8] 和PLCverif [12]，它们在本研究中也作为验证智能体的后端验证器使用。

二-C 基于LLM的智能体

LLM的快速发展将传统依赖于强化学习和符号逻辑的AI智能体 [53, 41, 23, 35, 21, 34] 提升到了一个新的水平，即基于LLM的智能体。在LLM的辅助下，这些智能体具有强大的语言理解、内容生成以及利用外部知识和工具的能力。它们能够通过智能体间的协作以及与环境的交互，来执行复杂任务并做出决策。LLM充当着智能体的"大脑"，负责核心推理与规划。任务规划模块利用LLM将复杂任务分解为多个可管理的子任务。记忆模块则负责存储历史交互信息与外部知识，为决策提供上下文。工具调用模块使智能体能够与外部环境（如PLC开发工具、验证器）进行交互，执行具体操作并获取反馈。这种架构使得智能体能够处理PLC代码生成与验证这类需要多步骤推理和专业工具使用的复杂流程。
