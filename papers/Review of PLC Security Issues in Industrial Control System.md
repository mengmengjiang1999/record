# Review of PLC Security Issues in Industrial Control System

https://www.semanticscholar.org/paper/Review-of-PLC-Security-Issues-in-Industrial-Control-Pan-Wang/2480a0d5bed1aac9474084e70457f4ac24293a7c?p2df


目前研究比较多的是code，firmware，network，modbus

在第3.1节 "Code Security Issue" 中，文章讨论了与PLC编程代码相关的安全问题。以下是该部分的主要内容：

1. **代码安全问题的分类**：在绘制梯形图的过程中，由于人员的疏忽可能会产生一些潜在的安全漏洞。文章提供了一个代码安全问题的分类和描述表（表1），包括逻辑错误、定时器条件竞争、无条件转移、代码无法到达、无限循环、语法错误、作用域和链接错误、隐藏跳转器、重复对象和未使用对象等问题。

2. **代码安全问题的后果**：每种分类的安全问题都可能导致不同的后果，例如定时器振荡、某些分支无法访问、循环超时错误、易于受到攻击和改变过程、恶意程序嵌入、程序执行过程改变、输出失败、攻击者利用等。

3. **代码安全的形式化分析方法**：为了检测PLC中的安全问题，文章介绍了模型检测作为目前最广泛使用的PLC形式化分析方法。该方法将PLC梯形图或指令列表语言等转换成中间语言，以便于模型构建。然后考虑环境和其他因素构建模型，并通过符号执行来解决状态空间爆炸问题，并最终检查各种代码缺陷。

4. **技术路线**：文章描述了PLC代码安全形式化检查的技术路线（图6），包括中间语言转换、模型检测、符号执行等步骤。

5. **符号执行的局限性**：符号执行虽然可以解决状态空间爆炸问题，但会消耗大量时间和内存，因此对于大型程序的检测时间较长。此外，由于它使用静态分析方法，无法检测分配给PLC的虚假传感器值。

6. **中间语言转换**：为了更好地解决中间语言转换问题，文章提到了Daravas提出的基于NuSMV的中间模型方法和McLaughlin提出的基于Vine的方法。

7. **模型检测**：模型检测可以构建适当的模型来自动生成检查系统。目前使用的模型检测工具包括SMV、UPPALL、SPIN、Verilog、TSV等。为了解决状态空间爆炸问题，GUO等人开发了SymPLC，这是一个自动符号检测工具，可以在符号执行前将PLC源代码转换为C语言。

文章通过详细讨论PLC编程代码的安全问题和分析方法，强调了在PLC编程和系统设计中需要考虑的安全因素，以及如何通过形式化分析方法来提高代码的安全性。



在第3.2节 "PLC Firmware Security" 中，文章讨论了与PLC固件安全相关的问题和保护方法。以下是该部分的主要内容：

1. **PLC固件修改攻击**：
   - 许多PLC允许用户远程下载固件更新，固件验证通常采用CRC校验和算法。但这种算法无法检测固件是否被故意修改。
   - 文章提到了Carl Schuett等人通过重新打包修改后的固件对PLC实施攻击的案例。

2. **实验平台结构**：
   - 描述了实验平台的结构，包括使用的硬件设备和攻击步骤，例如硬件分析、固件分析和识别可修改的固件部分。

3. **固件分析**：
   - 固件分析主要涉及修改和重新打包固件镜像，以执行攻击者修改过的程序。通常使用IDA PRO进行静态分析，并通过设备的JTAG结构进行测试。

4. **固件安全性检测方法**：
   - Qiao等人提出了一种设计可信PLC的方法，使用信任芯片和信任度量根，结合哈希算法，在系统启动阶段通过信任链传递来实现PLC的可信启动。
   - 包括认证机制和完整性检查两种方法。认证机制依靠固件代码BL0作为信任基础，完整性检查在设备启动时调用每个文件的哈希码段来执行完整性检查。

5. **基于固件签名的检测方法**：
   - Adelstein等人介绍了一种基于固件签名的检测方法，允许在运行时检查固件。该技术基于高效代码认证(ECC)技术，通过认证编译器实现。

6. **固件安全性的局限性**：
   - 文章指出，尽管上述方法可以提高PLC固件在启动和运行期间的可信度，但它们无法验证非开源固件的安全性，并且不能检测恶意硬件和拒绝服务攻击。

文章通过讨论PLC固件的安全问题和提出的保护方法，强调了固件在PLC安全中的重要作用以及需要采取的预防措施，以确保工业控制系统的完整性和可靠性。


在第3.3节 "PLC Network Security" 中，文章讨论了与PLC网络安全相关的问题和保护措施。以下是该部分的主要内容：

### 3.3.1 PLC Network Security Threats
- **SCADA系统的作用**：SCADA系统是工业系统的重要组成部分，负责现场数据采集和监控。作为SCADA的核心控制器，PLC设备的运行干扰可能导致不可逆转的损失。
- **网络安全问题**：SCADA与现场PLC之间的通信存在众多安全问题。一旦SCADA系统连接到互联网，攻击者更容易利用这些潜在威胁。
- **具体攻击类型**：
  - **重放攻击**：可以通过同一主机地址捕获或同一网络中的另一主机进行，有效启动和停止PLC。
  - **中间人攻击**：利用TCP/IP和COTP协议以及ARP地址解析协议，通信容易受到中间人攻击。
  - **隐蔽命令修改攻击**：结合了重放攻击和中间人攻击，用于获取PCS7与PLC之间的通信，并在隐蔽模式下重放其他命令以干扰PLC操作。
  - **PLC蠕虫病毒**：PLC采用周期性扫描，每次执行程序后会刷新输入和存储区域，攻击者可以利用通信协议修改用户执行程序。

### 3.3.2 PLC Network Security Protection
- **工业控制网络的安全监管程序**：Chen等人提出了一个安全监管程序，采用三种数据采集方案（网络采集、协议直接采集和采集代理）来深入控制系统的现场控制设备，并监控原始网络数据或控制设备。
- **外部入侵检测**：监控系统是否激活远程连接服务或添加未授权进程或端口，以确定系统是否遭受外部网络入侵。
- **网络层监控**：监控工业系统的数据流量，检测来自未知来源的OPC读命令，判断监控网络层是否遭受入侵。
- **一致性检测方法**：对于敏感的“写”命令，通过比较从底层设备获取的命令数据与监控软件检测到的值，判断是否被篡改。
- **PLC内存变化检测**：Andres等人通过检测PLC内存变化来响应入侵，理论上可以检测输入和输出的攻击，但这种方法基于理论分析，存在无法防止输入寄存器被修改和增加控制系统延迟时间的问题。

- **恶意行为检测**：Stephen McLaughlin等人提出了一种将PLC代码转换为中间语言的方法，使用模型检查和符号执行生成PLC时间执行图，并最终验证每个状态下的安全属性以确定代码是否安全。但这种方法无法拦截数据注入攻击，且对于较大的程序检测时间较长。

- **Modbus协议安全问题**：Modbus协议缺乏认证、授权和加密，容易受到攻击。

文章通过讨论PLC网络安全的威胁和提出的保护措施，强调了在设计和实施工业控制系统时需要考虑网络安全的重要性，以及如何通过各种方法来增强系统的安全性和抵御网络攻击的能力。


在第3.4节 "Modbus Protocol Security" 中，文章专注于Modbus协议的安全性问题及其解决方案。Modbus协议在SCADA系统中广泛使用，用于PLC之间的数据通信或PLC与主计算机之间的通信。以下是该部分的主要内容：

### 3.4.1 Modbus Protocol Security Issue
- **认证缺失**：Modbus协议缺乏身份认证，攻击者可以伪造合法会话来控制现场设备。
- **授权缺失**：协议中没有访问控制的界限，任何用户都可以执行任何代码，为攻击者提供了便利。
- **加密缺失**：Modbus协议不对数据进行加密保护，攻击者可以轻易地窃听通信并获取敏感数据。

### 3.4.2 Modbus Protocol Protection
- **安全机制添加**：研究主要在三个方向上进行：在网关上添加安全机制、在终端设备上添加安全机制、对协议数据进行加密。
- **基于套接字通信的安全架构**：Igor等人设计了一个基于套接字通信的Modbus安全架构，使用TCP/IP和RSA加密/解密单元、SHA2摘要和时间戳分析器来提高安全性。
- **形式化建模**：Roberto等人提出了Modbus协议的形式化建模，并将其自动转换为Promela模型，使用模型检查方法定位易受攻击的属性。
- **加密算法增强**：Aamir等人使用AES、RSA和SHA-2等高级加密算法加密Modbus协议会话，设计了新的密码缓冲区(CB)，以增强安全性。

文章还提到了这些方法的一些缺点：
- 如果主机被控制，PLC将无条件接收来自主机的命令和程序，使得加密无效。
- 加密和解密过程消耗大量时间和资源，导致工业控制系统的时间延迟增加，当延迟过大时，不适合工业生产。

最后，文章总结了Modbus协议的安全性问题和提出的保护措施，强调了需要采取的预防措施，以确保工业控制系统的安全性和可靠性。




