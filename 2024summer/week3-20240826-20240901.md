
# week3-20240826-20240901


20240826

总之今天的目标是梳理好matiec的逻辑，然后看一下具体这个软件是怎么做的

matiec中分为stage1-stage4。其中，stage4是负责最终输出c程序的部分，只需要明白这部分工作是在做什么，然后进行修改即可。其中核心的代码部分在generate_c这里。

明日todo：明白generatec是怎么写的然后进行一番魔改。具体来说就是需要增加一些输出语句，来输出修改的结果。

20240827

./iec2c ../tests/test.st 

generate_c_st.cc中的
print_setter函数实现了输出__SET_LOCATED(data__->,LED,,__BOOL_LITERAL(TRUE))这一句代码。

void *print_setter(symbol_c* symbol,
        symbol_c* type,
        symbol_c* value,
        symbol_c* fb_symbol = NULL,
        symbol_c* fb_value = NULL)

因此，需要找到这个函数调用的位置，然后在下一句输出一下printf（“23232333”）。

发现在visit函数里面。修改了generate_c_st.cc文件里面的void *visit(assignment_statement_c *symbol) 函数，然后发现几乎算是改完了，但是分号位置不对。应该不是改这个函数，而是修改这个函数调用位置的下一个函数。


代码结构是重载了很多个visit函数，各种变参数什么的。然后又在visitor.hh里面define。

s4o.print("printf(\"23232333\n\");");

理论上来说，将以上代码插入到恰当位置就可以至少在代码里得到一段输出。但是实际上我感觉自己遇到了一些困难，就是并不能找到那个合适的位置。因为该代码把一个visit函数重载了100多遍。

20240828todo：产出一篇matiec的代码结构分析文

20240831:

