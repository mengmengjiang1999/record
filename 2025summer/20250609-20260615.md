# 20250609-20260615

你是一位PLC安全分析专家，对于PLC的代码安全领域有深入研究。你对于PLC和模糊测试非常熟悉。用户在撰写PLC的模糊测试相关的论文，研究思路是：针对PLC的代码安全进行模糊测试。你需要做的是：
1. 当用户对PLC的代码模糊测试问题提出研究思路时，从专业的角度给出分析和评价。
2. 当用户对PLC代码的功能提出问题时，对代码的作用进行分析，并解释每一部分代码的功能、逻辑和语法。
3. 如果代码使用了特定的库或方法，解释它们的作用以及如何与其他部分配合工作。
4. 确保语言通俗易懂，适合任何级别的编程学习者理解。
5. 如果需要，提供一些示例或变体，帮助更好地理解代码。

简介

在众多 PLC 代码的安全隐患中，竞态条件(Race Condition)因其触发机制的隐蔽性和后果的严重性，成为亟待解决的技术难点。这类漏洞通常源于 PLC 程序 中多个逻辑分支对共享资源(如输出线圈、数据寄存器)的非同步访问。在扫周期驱动机制与 IO 信号异步更新的耦合作用下，可能导致输出状态在输入稳态条件 下出现非确定性的跳变。

本研究聚焦于 PLC 内部逻辑安全的核心挑战，出了一套融合静态分析与动态验证的混合检测框架。针对 PLC 中竞争问题的特殊性，其检测难点主要体现在以下两个方面:

静态阶段的预判困境。竞争问题的时序依赖特征在代码层面缺乏明确的表达，仅通过语法或结构分析难以捕捉潜在的逻辑冲突。虽然使用静态分析方法在一定程度上可以检测出问题，但由于 PLC 程序的复杂性，时间和空间成本较高。而在 生产环境下验证的方法虽然能够通过触发异常输入来暴露问题，却往往滞后于实际损害的发生。输入空间的爆炸性复杂度。在工业控制场景中，PLC 程序通常具有多变量和强耦合的特性。传统的安全分析方法由于缺乏对硬件外设交互行为的适应能力，难以高效地遍历可能触发竞争的关键路径。
为此，本研究通过结合静态分析和动态分析，设计与实现了面向工业控制系统的动静态协同模糊测试框架。通过编译转换、虚拟化建模和混合分析三个维度 的技术创新，构建了完整的 PLC 代码安全测试技术体系。在方法论层面，本工作的创新性主要体现在三个维度。首先，通过引入定制化的模糊测试技术，突破了传统 PLC 代码安全性检测对人工规则的依赖，利用自动化输入变异挖掘潜在逻辑漏洞，显著升了检测效率与覆盖率。其次，针对 PLC 程序与物理外设深度绑定的特性，设计了通用型硬件交互模拟层，有效解决了模糊测试过程中传感器信号模拟与执行器状态反馈的适配难题，为工业控制场景下的动态测试提供了可扩展的平台。此外，创新性地将静态符号执行与动态模糊测试相结合的方法应用于 PLC 逻辑安全分析，构建了竞争问题的跨阶段检测链条——在静态分析阶段通过数据流与控制流分析定位重点外设接口，而在动态阶段则结 合时序约束注入与路径反馈优化，实现了竞争条件的可重复触发与根因定位。这一多维度分析方法不仅克服了单一技术的局限性，更为工业控制系统的安全基座构建提供了兼具理论深度与实践可行性的解决方案。


## 研究背景和目标

## 研究现状与相关工作

## 研究思路

## 方案设计和实现

## 预期成果与现阶段进展

## 后续工作计划


race问题出现的成因


静态分析	CODESYS Static Analysis	双线圈/多路径写冲突检测
动态模糊测试	AFL++ + PLCemu	时序敏感型竞态条件发现
形式化验证	UPPAAL	证明不存在特定时序条件下的竞态
硬件监控	NI PXIe-6571数字模式仪器	纳秒级信号跳变捕获


​​现象类别​​	​​具体表现​​	​​典型案例​​
​​输出信号抖动​​	- 电磁阀频繁误动作
- 电机无故启停
- 指示灯异常闪烁	汽车焊装线机器人突然停顿，导致焊接位置偏移
​​状态不一致​​	- HMI显示状态与实际设备不符
- 报警系统误报/漏报	石化厂阀门状态显示"已关闭"，实际仍处于开启状态
​​时序相关故障​​	- 急停响应延迟（超过EN 60204标准要求的停止时间）
- 安全联锁失效	冲压机安全门未完全闭合时模具已启动，造成设备损坏
​​数据损坏​​	- 计数器数值跳变
- 模拟量采集值异常波动	水处理厂PH值调节剂投放量突然归零，导致水质超标


1. 针对程序的语言方面

针对ST语言的模糊测试方案：针对原生的ST语言，以及将ST语言转化为其他高级语言的模糊测试方案。
针对梯形图语言的模糊测试方案：针对原生的梯形图语言如何进行模糊测试？

2. 具体的方案设计
   1. 程序的输入与输出 PLC 程序的输入来自外部设备(例如传感器等)信号，输出 则传递到外部执行单元(例如 LED 灯等)。为了􏰀高模糊测试的通用性，本系统 采用外部设备模拟系统来模拟外部设备的输入。具体方案已在上一节中􏰀到，外 部设备模拟基于时序约束模型，构建基于扫􏰁周期的状态机，与 PLC 代码进行交 互。出于效率考虑，采用的方法是构建时序外部设备模型，以便模糊测试能够尽可 能深入地探测。在模糊测试层，每次执行程序时都会与模拟的外部设备进行交互， 获取模拟外部设备􏰀供的输入数据，并进行下一步操作。
   2. 测试用例生成和变异的方法输入的测试用例包括对外设每个端口值进行时序建模后得到的结果。AFL++ 是一个基于 AFL 框架的模糊测试工具，采用多种种子变异方法以提高测试覆盖率并发现潜在错误。
   3. 程序出现崩溃时的检测和反馈程序状态检测。通过外设的抽象层来检测程序的输出是否产生了崩溃，因为并不是所有的崩溃都可以体现在程序执行方面

3. seed从哪里来？
    seed要自己写

4. 实验怎么做？
   + 测试用的测试集从哪里来？
     + github等地方找来的开源数据
       + 部分开源数据的处理：对数据进行解析，以及格式统一转换为matiec能够处理的格式
     + 通过G4ltl-st工具来生成测试集
   + 测试哪些方面的内容？



我的研究想要做以下几种方案的尝试：
方案1：
plc代码转换为C代码，然后再对其进行模糊测试
增加外设模拟层，以探测时序漏洞
对输入和输出内容进行检查，以探测输出的异常跳变
方案2:
直接对st语言进行模糊测试，利用afl框架，直接对st语言进行变异
方案3:
	   